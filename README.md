[![Build Status](https://travis-ci.com/bongi23/PLANTS-server.svg?token=fnFkY4h2CXiktq8gGght&branch=master)](https://travis-ci.com/bongi23/PLANTS-server)  [![Coverage Status](https://coveralls.io/repos/github/bongi23/PLANTS-server/badge.svg?branch=master)](https://coveralls.io/github/bongi23/PLANTS-server?branch=master)

# Overview
P.L.A.N.T.S.-Server is a flask application that exposes RESTful API to [P.L.A.N.T.S.](https://github.com/deselmo/PLANTS)
systems and to 3rd party applications that want to interact with the data collected and sent to this server by the 
P.L.A.N.T.S. sensors network.

The skeleton of this server was generated by the [swagger-codegen](https://github.com/swagger-api/swagger-codegen) project. 
This server uses the [Connexion](https://github.com/zalando/connexion) library on top of Flask and uses a [MongoDB](https://www.mongodb.com/)
for permanent storage of information    .

## Requirements
Python 3.5.2+

## Usage
To run the server, please execute the following from the root directory:

```
pip3 install -r requirements.txt
```

Export the variables:
```
export MONGODB='mongodb://localhost:27017/plantsDB'
export REDIS='redis://localhost:6379'
```

In  different terminals run respectively the following 2 commands:
```
redis-server

celery -A swagger_server.controllers.sink_controller.celery worker
```

And now in a third terminal run
```
python3 -m swagger_server
```

and open your browser to here:

```
http://localhost:8080/ui/
```

Your Swagger definition lives here:

```
http://localhost:8080/swagger.json
```

##Testing
To launch the unit tests:
```
pytest --cov-config .coveragerc --cov swagger_server swagger_server/test
```

## Running with Docker

To run the server on a Docker container, please execute the following from the root directory:

```
# building
docker-compose build --no-cache

# running
docker-compose up
```
